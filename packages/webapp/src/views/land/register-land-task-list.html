{% extends 'layout.html' %}

{% set pageHeading = "Register land as a biodiversity gain site" %}

{% block content %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            <h1 class="govuk-heading-xl">{{ pageHeading }}</h1>
            <h2 class="govuk-heading-s govuk-!-margin-bottom-2">Registration in progress</h2>
            <p class="govuk-body govuk-!-margin-bottom-4">You have completed {{ registrationCompletedTasks}} of 7 sections.</p>
            <ol class="app-task-list govuk-!-padding-top-3">
                {% for task in registrationTasks.taskList %}
                    <li>
                        <h2 class="app-task-list__section">{{ task.taskTitle }}</h2>
                        <ul class="app-task-list__items">
                            {% for taskItem in task.tasks %}
                                {% if task.taskTitle !== 'Submit your biodiversity gain site information' %}
                                    <li class="app-task-list__item">
                                      <span class="app-task-list__task-name">
                                          {% if taskItem.status == 'COMPLETED' %}
                                              <a href="{{ taskItem.completedTaskUrl }}" aria-describedby="your-details-status" id = "{{ taskItem.id }}">
                                                {{ taskItem.title }}
                                              </a>
                                          {% else %}
                                              <a href="{{ taskItem.startTaskUrl }}" aria-describedby="your-details-status" id = "{{ taskItem.id }}">
                                                {{ taskItem.title }}
                                              </a>
                                          {% endif %}
                                      </span>
                                        {% if taskItem.status !== 'COMPLETED' %}
                                            <strong class="govuk-tag govuk-tag--grey app-task-list__tag">
                                                {{ taskItem.status }}
                                            </strong>
                                        {% else %}
                                            <strong class="govuk-tag app-task-list__tag">
                                                {{ taskItem.status }}
                                            </strong>
                                        {% endif %}
                                    </li>
                                {% else %}
                                    <li>
                                        <ul class="app-task-list__items">
                                            <li class="app-task-list__item">
                                                {% if registrationCompletedTasks == 6 %}
                                                    <span class="app-task-list__task-name">
                                                            <a href="{{ taskItem.completedTaskUrl }}" aria-describedby="{{ registrationTasks.taskList[registrationTasks.taskList.length - 1].tasks[0].id }}">
                                                                {{ registrationTasks.taskList[registrationTasks.taskList.length - 1].tasks[0].title }}
                                                            </a>
                                                    </span>
                                                    <strong class="govuk-tag govuk-tag--grey app-task-list__tag">Not started yet</strong>
                                                {% else %}
                                                    <span>
                                                          {{ registrationTasks.taskList[registrationTasks.taskList.length - 1].tasks[0].title }}
                                                    </span>
                                                    <strong class="govuk-tag govuk-tag--grey app-task-list__tag">{{ taskItem.status }}</strong>
                                                {% endif %}
                                            </li>
                                        </ul>
                                    </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    </li>
                {% endfor %}
            </ol>
        </div>
    </div>
{% endblock %}
