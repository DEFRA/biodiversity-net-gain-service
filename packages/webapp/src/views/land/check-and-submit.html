{% extends 'form-layout.html' %}

{% set showSaveLink = true %}
{% set pageHeading = "Check your answers before submitting your information" %}

{% block formContent %}
  <div class="govuk-body">
    {% if err %}
      {% include "errorbanner.html" %}
    {% endif %}
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <h1 class="govuk-heading-xl">
          {{ pageHeading }}
        </h1>
        <!-- Your details -->
        <h2 class="govuk-heading-l">Your details</h2>
        {{ govukSummaryList({
          classes: 'govuk-!-margin-bottom-7',
          rows: [
            {
              key: {
                text: "Full name"
              },
              value: {
                html: "<span data-testid=\"applicant-full-name-value\">" + application.applicant.lastName + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.NAME,
                    text: "Change",
                    visuallyHiddenText: " full name"
                  }
                ]
              }
            },
            {
              key: {
                text: "Role"
              },
              value: {
                html: "<span data-testid=\"applicant-role-value\">" + application.applicant.role + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.ROLE,
                    text: "Change",
                    visuallyHiddenText: " role"
                  }
                ]
              }
            },
            {
              key: {
                text: "Email address"
              },
              value: {
                html: "<span data-testid=\"applicant-emailaddress-value\">" + application.applicant.emailaddress + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.EMAIL,
                    text: "Change",
                    visuallyHiddenText: " emailAddress"
                  }
                ]
              }
            }
            ]
          }) }}

        <!--Land boundary-->
        <h2 class="govuk-heading-l">Land boundary</h2>
        {% set landBoundaryUploadTypeElement = undefined if isRouteDisabled(routes.CHOOSE_LAND_BOUNDARY_UPLOAD) else {
          key: {
              text: "Land boundary file type"
          },
          value: {
            html: "<span data-testid=\"land-boundary-file-type-value\">" + landBoundaryUploadType + "</span>"
          },
          actions: {
            items: [
                {
                    href: routes.UPLOAD_LAND_BOUNDARY if isRouteDisabled(routes.UPLOAD_GEOSPATIAL_LAND_BOUNDARY) else routes.CHOOSE_LAND_BOUNDARY_UPLOAD,
                    text: "Change",
                    visuallyHiddenText: " land boundary file",
                    attributes: {
                        id: "check-land-boundary-file-type"
                    }
                }
            ]
          }
        } %}
        {{ govukSummaryList({
          classes: "govuk-!-margin-bottom-7",
          rows: [
            landBoundaryUploadTypeElement,
            {
              key: {
                text: "Land boundary file uploaded"
              },
              value: {
                html: "<span data-testid=\"land-boundary-file-name-value\">" + landBoundaryFileName + "</span>"
              },
              actions: {
                items: [
                  {
                    href: checkLandBoundaryLink,
                    text: "Change",
                    visuallyHiddenText: " land boundary file"
                  }
                ]
              }
            },
            {
              key: {
                text: "Land boundary on a map"
              },
              classes: hideClass(documentOrImage) + ' defra-js-show hidden',
              value: {
                html: "<div id=\"map\" data-testid=\"land-boundary-map-value\" class=\"map map--location\" tabindex=\"0\"></div>"
              }
            },
            {
              key: {
                text: "Grid reference"
              },
              value: {
                html: "<span data-testid=\"grid-reference-value\">" + gridReference + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.ADD_GRID_REFERENCE,
                    text: "Change",
                    visuallyHiddenText: " grid reference",
                    classes: hideClass(geospatial)
                  }
                ]
              }
            },
            {
              key: {
                text: "Area in hectares"
              },
              value: {
                html: "<span data-testid=\"area-in-hectares-value\">" + areaInHectare + "</span>"
              },              
              actions: {
                items: [
                  {
                    href: routes.ADD_HECTARES,
                    text: "Change",
                    visuallyHiddenText: " area in hectares",
                    classes: hideClass(geospatial)
                  }
                ]
              }
            }
          ]
        }) }}

        <!--Land ownership-->
        <h2 class="govuk-heading-l">Land ownership</h2>
        {{ govukSummaryList({
          classes: 'govuk-!-margin-bottom-7',
          rows: [
            {
              key: {
                text: "Proof of land ownership file uploaded"
              },
              value: {
                html: "<span data-testid=\"proof-land-ownership-file-name-value\">" + application.files[4].fileName + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.CHECK_PROOF_OF_OWNERSHIP,
                    text: "Change",
                    visuallyHiddenText: " land boundary file"
                  }
                ]
              }
            },
            {
              key: {
                text: "Landowner name"
              },
              value: {
                html: "<span data-testid=\"land-owner-names-value\">" + listArray(landownerNames) + "</span>"
              },
              actions: {
                items: [
                  {
                    href: changeLandownersHref,
                    text: "Change",
                    visuallyHiddenText: " landowner name"
                  }
                ]
              }
            },
            {
              key: {
                text: "Landowner consent"
              },
              classes: hideClass(hideConsent),
              value: {
                html: "<span data-testid=\"land-owner-consent-value\">" + boolToYesNo(application.landownerConsent) + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.LANDOWNER_CONSENT,
                    text: "Change",
                    visuallyHiddenText: " landowner consent"
                  }
                ]
              }
            }
          ]
        }) }}

        <!--Biodiversity Metric-->
        <h2 class="govuk-heading-l">Biodiversity Metric</h2>

        {{ govukSummaryList({
          classes: 'govuk-!-margin-bottom-7',
          rows: [
            {
              key: {
                text: "Biodiversity Metric file uploaded"
              },
              value: {
                html: "<span data-testid=\"metric-file-name-value\">" + application.files[3].fileName + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.CHECK_UPLOAD_METRIC,
                    text: "Change",
                    visuallyHiddenText: " Biodiversity Metric file"
                  }
                ]
              }
            }
          ]
        }) }}

        <!--Habitat management and monitoring plan-->
        <h2 class="govuk-heading-l">Habitat management and monitoring</h2>
        {{ govukSummaryList({
          classes: 'govuk-!-margin-bottom-7',
          rows: [
            {
              key: {
                text: "Habitat management and monitoring plan uploaded"
              },
              value: {
                html: "<span data-testid=\"habitat-plan-file-name-value\">" + application.files[2].fileName + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.CHECK_MANAGEMENT_PLAN,
                    text: "Change",
                    visuallyHiddenText: " habitat management and monitoring plan"
                  }
                ]
              }
            },
            {
              key: {
                text: "Start date of habitat enhancement works"
              },
              value: {
                html: "<span data-testid=\"habitat-work-start-date-value\">" + dateToString(application.habitatWorkStartDate) + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.HABITAT_WORKS_START_DATE,
                    text: "Change",
                    visuallyHiddenText: " commencement date of habitat works"
                  }
                ]
              }
            },
            {
              key: {
                text: "Start date of the 30 year management and monitoring period"
              },
              value: {
                html: "<span data-testid=\"management-monitoring-start-date-value\">" + dateToString(application.managementMonitoringStartDate) + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.MANAGEMENT_MONITORING_START_DATE,
                    text: "Change",
                    visuallyHiddenText: " start date of the 30 year management and monitoring period"
                  }
                ]
              }
            }
          ]
        }) }}

        <!-- Legal agreement -->
        <h2 class="govuk-heading-l">Legal information</h2>
        {{ govukSummaryList({
          classes: 'govuk-!-margin-bottom-7',
          rows: [
            {
              key: {
                text: "Type of legal agreement"
              },
              value: {
                html: "<span data-testid=\"legal-agreement-type-value\">" + legalAgreementType + "</span>"
              },
              actions: {
                items: [
                  {
                    href: "/land/legal-agreement-type",
                    text: "Change",
                    visuallyHiddenText: " type of legal agreement"
                  }
                ]
              }
            },
            {
              key: {
                text: "Legal agreement file uploaded"
              },
              value: {
                html: "<span data-testid=\"legal-agreement-file-name-value\">" + application.files[0].fileName + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.CHECK_LEGAL_AGREEMENT,
                    text: "Change",
                    visuallyHiddenText: " legal agreement file"
                  }
                ]
              }
            },
            {
              key: {
                text: "Parties involved"
              },
              value: {
                html: "<span data-testid=\"legal-agreement-parties-value\">" + listArray(legalAgreementParties) + "</span>"
              },
              actions: {
                items: [
                  {
                    href: "/land/add-legal-agreement-parties",
                    text: "Change",
                    visuallyHiddenText: " parties involved"
                  }
                ]
              }
            },
            {
              key: {
                text: "Start date"
              },
              value: {
                html: "<span data-testid=\"legal-agreement-start-date-value\">" +  dateToString(application.legalAgreementStartDate) + "</span>"
              },
              actions: {
                items: [
                  {
                    href: "/land/legal-agreement-start-date",
                    text: "Change",
                    visuallyHiddenText: " start date"
                  }
                ]
              }
            },
            {
              key: {
                text: "Local land charge search certificate file uploaded"
              },
              value: {
                html: "<span data-testid=\"local-land-charge-file-name-value\">" + application.files[5].fileName + "</span>"
              },
              actions: {
                items: [
                  {
                    href: routes.CHECK_LOCAL_LAND_CHARGE_FILE,
                    text: "Change",
                    visuallyHiddenText: " local land charge file"
                  }
                ]
              }
            }
          ]
        }) }}

        <h2 class="govuk-heading-l">Submit your biodiversity gain site information</h2>

        <p class="govuk-body">By submitting your information you agree that:</p>
        <ul class="govuk-list govuk-list--bullet">
          <li>it is true, to the best of your knowledge and belief</li>
          <li>you have got, or will get, all consents, licences or other permissions needed to carry out the enhancement works</li>
        </ul>
        <div class="govuk-warning-text">
          <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
          <strong class="govuk-warning-text__text">
            <span class="govuk-warning-text__assistive">Warning</span>
            You may have to pay a fine if you have given false information.
          </strong>
        </div>
        {{ govukButton({
          text: "Confirm and submit",
          attributes: {
            "data-testid": "continue"
          }
        }) }}
      </div>
    </div>
  </div>
{% endblock %}
{% block bodyEnd %}
    {{ super() }}
    {% if geospatial %}
    <script src="{{ assetPath }}/js/checkAndSubmit.js"></script>
    <script>
      const safeMapConfig = {{ mapConfig | dump | safe }}
      checkAndSubmit.initialiseMap(safeMapConfig)
    </script>
    {% endif %}
{% endblock %}
