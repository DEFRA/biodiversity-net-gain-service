{% extends 'form-layout.html' %}

{% from "govuk/components/radios/macro.njk" import govukRadios %}

{% set pageHeading = "Check the biodiversity gain site land boundary details" %}

{% block formContent %}
    <div class="govuk-body">
        {% if err %}
            {% include "errorbanner.html" %}
        {% endif %}
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                {{ govukFieldset({
                    legend: {
                        text: pageHeading,
                        classes: "govuk-fieldset__legend--l",
                        isPageHeading: true
                    }
                }) }}
                <form method="post">
                    {% set landBoundaryFileNameElement = {
                        key: {
                            text: 'File type'
                        },
                        value: {
                            html: "<span data-testid=\"land-boundary-file-type-value\">" + landBoundaryUploadType + "</span>"
                        },
                        actions: {
                            items: [
                                {
                                    href: routes.CHOOSE_LAND_BOUNDARY_UPLOAD if ENABLE_ROUTE_SUPPORT_FOR_GEOSPATIAL === 'Y' else routes.UPLOAD_GEOSPATIAL_LAND_BOUNDARY,
                                    text: 'Change',
                                    visuallyHiddenText: ' land boundary file',
                                    attributes: {
                                        id: "check-land-boundary-file-type"
                                    }
                                }
                            ]
                        }
                    } if isGeosptialDisabled else undefined %}

                    {% set boundaryOnAMapElement = {
                        key: {
                          text: "Boundary on a map"
                        },
                        classes: hideClass(documentOrImage) + ' defra-js-show hidden',
                        value: {
                          html: "<div id=\"map\" class=\"map map--location\" tabindex=\"0\" data-testid=\"land-boundary-map-value\"></div>"
                        }
                    } if ENABLE_ROUTE_SUPPORT_FOR_GEOSPATIAL === 'Y' else undefined %}

                    {{ govukSummaryList({
                        rows: [
                            landBoundaryFileNameElement,
                            {
                                key: {
                                      text: 'File uploaded'
                                  },
                                  value: {
                                      html: "<span data-testid=\"land-boundary-file-name-value\">" + landBoundaryFileName + "</span>"
                                  },
                                  actions: {
                                    items: [
                                        {
                                            href: checkLandBoundaryLink,
                                            text: 'Change',
                                            visuallyHiddenText: ' land boundary file',
                                            attributes: {
                                                id: "check-land-boundary-file"
                                            }
                                        }
                                    ]
                                  }
                            },
                            boundaryOnAMapElement,
                            {
                            key: {
                                text: 'Grid reference'
                            },
                            value: {
                                html: "<span data-testid=\"grid-reference-value\">" + gridReference + "</span>"
                            },
                            actions: {
                                items: [
                                    {
                                        href: routes.ADD_GRID_REFERENCE,
                                        text: 'Change',
                                        visuallyHiddenText: ' grid reference',
                                        classes: hideClass(geospatial),
                                        attributes: {
                                            id: "add-grid-reference"
                                        }
                                    }
                                ]
                            }
                            },
                            {
                              key: {
                                  text: 'Area in hectares'
                              },
                              value: {
                                  html: "<span data-testid=\"area-in-hectares-value\">" + areaInHectare + "</span>"
                              },
                              actions: {
                              items: [
                                  {
                                      href: routes.ADD_HECTARES,
                                      text: 'Change',
                                      visuallyHiddenText: ' area in hectares',
                                      classes: hideClass(geospatial),
                                      attributes: {
                                          id: "add-hectares"
                                      }
                                  }
                              ]
                            }
                          }
                        ]
                    }) }}
                <form method="post">
                    {{ govukButton({
                        text: "Save and continue",
                        attributes: {
                            id: "continue",
                            "data-testid": "continue"
                        }
                    }) }}
                </form>
            </div>
        </div>
    </div>
{% endblock %}
{% block bodyEnd %}
    {{ super() }}
    {% if geospatial %}
    <script src="{{ assetPath }}/js/checkLandBoundaryDetails.js"></script>
    <script>
      const safeMapConfig = {{ mapConfig | dump | safe }}
      checkLandBoundaryDetails.initialiseMap(safeMapConfig)
    </script>
    {% endif %}
{% endblock %}
