{% extends 'form-layout.html' %}

{% from "govuk/components/radios/macro.njk" import govukRadios %}

{% set showSaveLink = true %}
{% set pageHeading = "Add all parties listed on the " + legalAgreementType %}

{% block formContent %}
    <div class="govuk-body">
        {% if err %}
            {% include "errorbanner.html" %}
        {% endif %}
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                <div id="moj-add-another-component" data-module="moj-add-another">
                    <h1 class="govuk-heading-l" tabindex="-1">
                        {{ pageHeading }}
                    </h1>
                    <form method="post">
                        {{ govukInput({
                            id: "organisation[organisationName]",
                            name: "organisation[organisationName]",
                            value: organisation["organisation[organisationName]"],
                            label: {
                                text: "Full name or organisation"
                            },
                            errorMessage: orgErrorMessage,
                            attributes: {
                                "data-name": "organisation[organisationName]",
                                "data-id": "organisation[organisationName]",
                                "aria-describedby": "organisation[organisationName]"
                            }
                        }) }}

                        {% set role = organisation["organisation[role]"] %}

                        {{ govukRadios({
                            name: "organisation[role]",
                            fieldset: {
                                legend: {
                                    text: "Role",
                                    classes: "govuk-fieldset__legend"
                                }
                            },
                            attributes: {
                                id: "organisation[role]"
                            },
                            hint: {
                                html: "<div class='govuk-hint'>Select one option.</div>"
                            },
                            errorMessage: roleErrorMessage,
                            items: [
                                {
                                    id: "localAuthority[role]",
                                    name: "organisation[role]",
                                    value: "Local authority",
                                    text: "Local authority",
                                    checked: role === "Local authority",
                                    classes: "govuk-input--width-2",
                                    attributes: {
                                        "data-name": "organisationError[role]",
                                        "data-id": "organisation[role]",
                                        "aria-describedby": "countyCouncil[role]"
                                    }
                                },
                                {
                                    id: "developer[role]",
                                    name: "organisation[role]",
                                    value: "Developer",
                                    text: "Developer",
                                    checked: role === "Developer",
                                    classes: "govuk-input--width-2",
                                    attributes: {
                                        "data-name": "organisation[role]",
                                        "data-id": "organisation[role]",
                                        "aria-describedby": "developer[role]"
                                    }
                                },
                                {
                                    id: "landOwner[role]",
                                    name: "organisation[role]",
                                    value: "Landowner",
                                    text: "Landowner",
                                    checked: role === "Landowner",
                                    classes: "govuk-input--width-2",
                                    attributes: {
                                        "data-name": "organisation[role]",
                                        "data-id": "organisation[role]",
                                        "aria-describedby": "landowner[role]"
                                    }
                                },
                                {
                                    id: "responsibleBody[role]",
                                    name: "organisation[role]",
                                    value: "Responsible body",
                                    text: "Responsible body",
                                    checked: role === "Responsible body",
                                    classes: "govuk-input--width-2",
                                    attributes: {
                                        "data-name": "organisation[role]",
                                        "data-id": "organisation[role]",
                                        "aria-describedby": "responsible[role]"
                                    }
                                },
                                {
                                    id: "other[role]",
                                    name: "organisation[role]",
                                    value: "Other",
                                    text: "Other",
                                    checked: role === "Other",
                                    classes: "govuk-input--width-2",
                                    conditional: {
                                        html: '<div id="other-role">
                                                <div class="govuk-form-group">
                                                    <label class="govuk-label" for="other-party">
                                                        Role
                                                    </label>
                                                    <input class="govuk-input govuk-!-width-one-third" value="' + organisation.otherPartyName  + '" name="otherPartyName">
                                                </div>
                                            </div>'
                                    },
                                    attributes: {
                                        "data-name": "organisation[role]",
                                        "data-id": "other[role]",
                                        "aria-describedby": "organisation[role]"
                                    }
                                }
                            ]
                        }) }}

                        <div class="moj-button-action">
                            {{ govukButton({
                                text: "Continue",
                                attributes: {
                                    id: "continue",
                                    "data-testid": "continue"
                                }
                            }) }}
                        </div>
                    </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block bodyEnd %}
    {{ super() }}
    <script src="{{ assetPath }}/js/addLegalAgreementParties.js"></script>
{% endblock %}
